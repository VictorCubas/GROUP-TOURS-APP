# ğŸ”„ Flujo de Vistas - Notas de CrÃ©dito

> Diagramas ASCII del flujo de usuario para la generaciÃ³n de Notas de CrÃ©dito desde el Tab de Facturas

---

## ğŸ“‹ Ãndice

1. [Flujo Principal de NavegaciÃ³n](#flujo-principal-de-navegaciÃ³n)
2. [Vista: Tab de Facturas](#vista-tab-de-facturas)
3. [Flujo: Generar NC Total](#flujo-generar-nc-total)
4. [Flujo: Generar NC Parcial](#flujo-generar-nc-parcial)
5. [Vista: Modal de GeneraciÃ³n NC](#vista-modal-de-generaciÃ³n-nc)
6. [Vista: Lista de NC Existentes](#vista-lista-de-nc-existentes)
7. [Estados de Factura](#estados-de-factura)
8. [Flujo de Errores](#flujo-de-errores)

---

## ğŸ”€ Flujo Principal de NavegaciÃ³n

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      SISTEMA GROUPTOURS                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                                â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  Lista de Reservas    â”‚
                    â”‚  /reservas            â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                                â”‚ [Click en Reserva]
                                â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  Detalle de Reserva   â”‚
                    â”‚  /reservas/:id        â”‚
                    â”‚                       â”‚
                    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
                    â”‚  â”‚ Tab: General    â”‚  â”‚
                    â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
                    â”‚  â”‚ Tab: Pasajeros  â”‚  â”‚
                    â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
                    â”‚  â”‚ Tab: Pagos      â”‚  â”‚
                    â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
                    â”‚  â”‚ Tab: FACTURAS â—„â”€â”¼â”€â”€â”¼â”€â”€ INICIO DEL FLUJO
                    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                                â”‚ [Click en Tab Facturas]
                                â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  Tab Facturas         â”‚
                    â”‚  (Ver diagrama        â”‚
                    â”‚   detallado abajo)    â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“„ Vista: Tab de Facturas

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                    RESERVA: RSV-2025-00123                         â•‘
â•‘  [General] [Pasajeros] [Pagos] [FACTURAS] â—„â”€â”€ Tab Activo          â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘                                                                    â•‘
â•‘  Facturas de esta Reserva                                         â•‘
â•‘                                                                    â•‘
â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â•‘
â•‘  â”‚ ğŸ“„ Factura: 001-001-0000456                              â”‚     â•‘
â•‘  â”‚                                                           â”‚     â•‘
â•‘  â”‚    Tipo: Global                                          â”‚     â•‘
â•‘  â”‚    Cliente: Juan PÃ©rez (CI: 12345678)                    â”‚     â•‘
â•‘  â”‚    Fecha: 15/10/2025 14:30                               â”‚     â•‘
â•‘  â”‚    Total: PYG 12.000.000                                 â”‚     â•‘
â•‘  â”‚                                                           â”‚     â•‘
â•‘  â”‚    Estado: âœ… ACTIVA                                     â”‚     â•‘
â•‘  â”‚    â”œâ”€ Total Original:  PYG 12.000.000                    â”‚     â•‘
â•‘  â”‚    â”œâ”€ Total Acreditado: PYG 0                            â”‚     â•‘
â•‘  â”‚    â””â”€ Saldo Neto:      PYG 12.000.000                    â”‚     â•‘
â•‘  â”‚                                                           â”‚     â•‘
â•‘  â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚     â•‘
â•‘  â”‚    â”‚  [ğŸ“¥ Descargar PDF]  [ğŸ”´ Generar NC] â—„â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€ ACCIÃ“N PRINCIPAL
â•‘  â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚     â•‘
â•‘  â”‚                                                           â”‚     â•‘
â•‘  â”‚    Notas de CrÃ©dito: (0)                                 â”‚     â•‘
â•‘  â”‚    â””â”€ No hay notas de crÃ©dito                            â”‚     â•‘
â•‘  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â•‘
â•‘                                                                    â•‘
â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â•‘
â•‘  â”‚ ğŸ“„ Factura: 001-001-0000457                              â”‚     â•‘
â•‘  â”‚                                                           â”‚     â•‘
â•‘  â”‚    Tipo: Individual (Pasajero: MarÃ­a GonzÃ¡lez)           â”‚     â•‘
â•‘  â”‚    Fecha: 16/10/2025 10:15                               â”‚     â•‘
â•‘  â”‚    Total: PYG 3.000.000                                  â”‚     â•‘
â•‘  â”‚                                                           â”‚     â•‘
â•‘  â”‚    Estado: âš ï¸  PARCIALMENTE ACREDITADA                   â”‚     â•‘
â•‘  â”‚    â”œâ”€ Total Original:  PYG 3.000.000                     â”‚     â•‘
â•‘  â”‚    â”œâ”€ Total Acreditado: PYG 1.500.000                    â”‚     â•‘
â•‘  â”‚    â””â”€ Saldo Neto:      PYG 1.500.000                     â”‚     â•‘
â•‘  â”‚                                                           â”‚     â•‘
â•‘  â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚     â•‘
â•‘  â”‚    â”‚  [ğŸ“¥ Descargar PDF]  [ğŸ”´ Generar NC]        â”‚      â”‚     â•‘
â•‘  â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚     â•‘
â•‘  â”‚                                                           â”‚     â•‘
â•‘  â”‚    Notas de CrÃ©dito: (1) [Ver Todas â–¼]                  â”‚     â•‘
â•‘  â”‚    â”œâ”€ ğŸ“‹ NC: 001-001-0000078 | PYG 1.500.000            â”‚     â•‘
â•‘  â”‚    â”‚   Tipo: Parcial | Motivo: Descuento                â”‚     â•‘
â•‘  â”‚    â”‚   [Ver PDF]                                         â”‚     â•‘
â•‘  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â•‘
â•‘                                                                    â•‘
â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â•‘
â•‘  â”‚ ğŸ“„ Factura: 001-001-0000458                              â”‚     â•‘
â•‘  â”‚                                                           â”‚     â•‘
â•‘  â”‚    Tipo: Global                                          â”‚     â•‘
â•‘  â”‚    Total: PYG 8.000.000                                  â”‚     â•‘
â•‘  â”‚                                                           â”‚     â•‘
â•‘  â”‚    Estado: ğŸš« TOTALMENTE ANULADA                         â”‚     â•‘
â•‘  â”‚    â”œâ”€ Total Original:  PYG 8.000.000                     â”‚     â•‘
â•‘  â”‚    â”œâ”€ Total Acreditado: PYG 8.000.000                    â”‚     â•‘
â•‘  â”‚    â””â”€ Saldo Neto:      PYG 0                             â”‚     â•‘
â•‘  â”‚                                                           â”‚     â•‘
â•‘  â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚     â•‘
â•‘  â”‚    â”‚  [ğŸ“¥ Descargar PDF]  [ğŸ”´ Generar NC] â—„â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€ DESHABILITADO
â•‘  â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚     â•‘
â•‘  â”‚                     â–²                                     â”‚     â•‘
â•‘  â”‚                     â””â”€ BotÃ³n deshabilitado                â”‚     â•‘
â•‘  â”‚                                                           â”‚     â•‘
â•‘  â”‚    Notas de CrÃ©dito: (1) [Ver Todas â–¼]                  â”‚     â•‘
â•‘  â”‚    â”œâ”€ ğŸ“‹ NC: 001-001-0000080 | PYG 8.000.000            â”‚     â•‘
â•‘  â”‚    â”‚   Tipo: Total | Motivo: CancelaciÃ³n de Reserva     â”‚     â•‘
â•‘  â”‚    â”‚   [Ver PDF]                                         â”‚     â•‘
â•‘  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â•‘
â•‘                                                                    â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

---

## ğŸ”´ Flujo: Generar NC Total

```
USUARIO: Click en "Generar NC"
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ValidaciÃ³n Frontend                     â”‚
â”‚                                         â”‚
â”‚ Â¿Factura totalmente acreditada?         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â”œâ”€[SÃ]â”€â”€â–º âŒ Mostrar Error:
    â”‚         "Esta factura ya estÃ¡
    â”‚          totalmente anulada"
    â”‚
    â””â”€[NO]â”€â”€â–º Continuar
                â”‚
                â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  Modal: Generar NC        â”‚
    â”‚                           â”‚
    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
    â”‚  â”‚ â— NC Total          â”‚â—„â”€â”¼â”€â”€ OpciÃ³n seleccionada
    â”‚  â”‚ â—‹ NC Parcial        â”‚  â”‚
    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
    â”‚                           â”‚
    â”‚  Motivo:                  â”‚
    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
    â”‚  â”‚ CancelaciÃ³n Reserva â–¼â”‚  â”‚
    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
    â”‚                           â”‚
    â”‚  Observaciones:           â”‚
    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
    â”‚  â”‚ Cliente cancelÃ³...  â”‚  â”‚
    â”‚  â”‚                     â”‚  â”‚
    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
    â”‚                           â”‚
    â”‚  [Cancelar] [Generar NC]  â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚
                â”‚ [Click Generar NC]
                â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  ValidaciÃ³n de Datos      â”‚
    â”‚  - Â¿Motivo seleccionado?  â”‚
    â”‚  - Â¿ConfirmaciÃ³n usuario? â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚
                â”‚ [ValidaciÃ³n OK]
                â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  Llamada API              â”‚
    â”‚  POST /api/facturacion/   â”‚
    â”‚  generar-nota-credito-    â”‚
    â”‚  total/{factura_id}/      â”‚
    â”‚                           â”‚
    â”‚  Body: {                  â”‚
    â”‚    motivo: "...",         â”‚
    â”‚    observaciones: "..."   â”‚
    â”‚  }                        â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚
                â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  Procesamiento Backend    â”‚
    â”‚                           â”‚
    â”‚  1. Validar factura       â”‚
    â”‚  2. Copiar detalles       â”‚
    â”‚  3. Calcular totales      â”‚
    â”‚  4. Generar PDF           â”‚
    â”‚  5. Guardar NC            â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚
                â”œâ”€[ERROR]â”€â”€â”
                â”‚          â”‚
                â”‚          â–¼
                â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â”‚     â”‚  Respuesta 400     â”‚
                â”‚     â”‚  {                 â”‚
                â”‚     â”‚    error: "..."    â”‚
                â”‚     â”‚  }                 â”‚
                â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚          â”‚
                â”‚          â–¼
                â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â”‚     â”‚  Mostrar Error     â”‚
                â”‚     â”‚  en Modal          â”‚
                â”‚     â”‚  âŒ [mensaje]      â”‚
                â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚
                â””â”€[Ã‰XITO]â”€â–º â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                            â”‚  Respuesta 201 Created     â”‚
                            â”‚  {                         â”‚
                            â”‚    message: "NC generada", â”‚
                            â”‚    nota_credito: {...}     â”‚
                            â”‚  }                         â”‚
                            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                                    â–¼
                            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                            â”‚  Actualizar UI             â”‚
                            â”‚                            â”‚
                            â”‚  1. Cerrar modal           â”‚
                            â”‚  2. Recargar facturas      â”‚
                            â”‚  3. Mostrar notificaciÃ³n   â”‚
                            â”‚     âœ… NC 001-001-0000078  â”‚
                            â”‚        generada            â”‚
                            â”‚  4. Abrir PDF automÃ¡tico   â”‚
                            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                                    â–¼
                            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                            â”‚  Factura Actualizada       â”‚
                            â”‚                            â”‚
                            â”‚  Estado: ğŸš« ANULADA        â”‚
                            â”‚  Saldo: PYG 0              â”‚
                            â”‚  BotÃ³n "Generar NC": OFF   â”‚
                            â”‚                            â”‚
                            â”‚  NC Asociadas: (1)         â”‚
                            â”‚  â””â”€ 001-001-0000078        â”‚
                            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## âš ï¸ Flujo: Generar NC Parcial

```
USUARIO: Click en "Generar NC"
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Modal: Generar NC                       â”‚
â”‚                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚
â”‚  â”‚ â—‹ NC Total          â”‚                â”‚
â”‚  â”‚ â— NC Parcial        â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ OpciÃ³n seleccionada
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚
â”‚                                         â”‚
â”‚  Motivo:                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚
â”‚  â”‚ ReducciÃ³n Pasajerosâ–¼â”‚                â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚
â”‚                                         â”‚
â”‚  Items a Acreditar:                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Item 1: Paquete Tour a IguazÃº    â”‚  â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚
â”‚  â”‚ â”‚ Cantidad: 2 â”‚ â”‚ Precio: 2.5M â”‚ â”‚  â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚
â”‚  â”‚ Subtotal: PYG 5.000.000          â”‚  â”‚
â”‚  â”‚                        [Eliminar] â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                         â”‚
â”‚  [+ Agregar Item]                       â”‚
â”‚                                         â”‚
â”‚  Total a Acreditar: PYG 5.000.000       â”‚
â”‚  Saldo Disponible:  PYG 12.000.000      â”‚
â”‚  Saldo Restante:    PYG 7.000.000       â”‚
â”‚                                         â”‚
â”‚  Observaciones:                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚
â”‚  â”‚ 2 pasajeros         â”‚                â”‚
â”‚  â”‚ cancelaron          â”‚                â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚
â”‚                                         â”‚
â”‚  [Cancelar] [Generar NC Parcial]        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚
            â”‚ [Click Generar]
            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ValidaciÃ³n Frontend                    â”‚
â”‚  - Â¿Motivo seleccionado?                â”‚
â”‚  - Â¿Al menos 1 item?                    â”‚
â”‚  - Â¿Monto <= saldo disponible?          â”‚
â”‚  - Â¿ConfirmaciÃ³n usuario?               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚
            â”‚ [ValidaciÃ³n OK]
            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Llamada API                            â”‚
â”‚  POST /api/facturacion/                 â”‚
â”‚  generar-nota-credito-parcial/          â”‚
â”‚  {factura_id}/                          â”‚
â”‚                                         â”‚
â”‚  Body: {                                â”‚
â”‚    motivo: "reduccion_pasajeros",       â”‚
â”‚    observaciones: "2 pasajeros...",     â”‚
â”‚    items: [                             â”‚
â”‚      {                                  â”‚
â”‚        descripcion: "Paquete...",       â”‚
â”‚        cantidad: 2,                     â”‚
â”‚        precio_unitario: 2500000         â”‚
â”‚      }                                  â”‚
â”‚    ]                                    â”‚
â”‚  }                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚
            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Procesamiento Backend                  â”‚
â”‚                                         â”‚
â”‚  1. Validar factura                     â”‚
â”‚  2. Validar saldo disponible            â”‚
â”‚  3. Crear NC                            â”‚
â”‚  4. Crear detalles (items)              â”‚
â”‚  5. Calcular totales                    â”‚
â”‚  6. Generar PDF                         â”‚
â”‚  7. Guardar                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚
            â”œâ”€[ERROR]â”€â”€â”
            â”‚          â”‚
            â”‚          â–¼
            â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚     â”‚  Posibles Errores:         â”‚
            â”‚     â”‚                            â”‚
            â”‚     â”‚  âŒ Saldo insuficiente     â”‚
            â”‚     â”‚  âŒ Items invÃ¡lidos        â”‚
            â”‚     â”‚  âŒ Factura inactiva       â”‚
            â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚          â”‚
            â”‚          â–¼
            â”‚     Mostrar error en modal
            â”‚
            â””â”€[Ã‰XITO]â”€â–º â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                        â”‚  Respuesta 201       â”‚
                        â”‚  nota_credito: {...} â”‚
                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                                â–¼
                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                        â”‚  Actualizar UI       â”‚
                        â”‚                      â”‚
                        â”‚  1. Cerrar modal     â”‚
                        â”‚  2. Recargar datos   â”‚
                        â”‚  3. NotificaciÃ³n OK  â”‚
                        â”‚  4. Abrir PDF        â”‚
                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                                â–¼
                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                        â”‚  Factura Actualizada     â”‚
                        â”‚                          â”‚
                        â”‚  Estado: âš ï¸  PARCIALMENTEâ”‚
                        â”‚          ACREDITADA      â”‚
                        â”‚                          â”‚
                        â”‚  Total:      12.000.000  â”‚
                        â”‚  Acreditado:  5.000.000  â”‚
                        â”‚  Saldo:       7.000.000  â”‚
                        â”‚                          â”‚
                        â”‚  NC Asociadas: (1)       â”‚
                        â”‚  â””â”€ 001-001-0000079      â”‚
                        â”‚     Parcial | 5.000.000  â”‚
                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ’¬ Vista: Modal de GeneraciÃ³n NC

### Modal - Paso 1: SelecciÃ³n de Tipo

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                   GENERAR NOTA DE CRÃ‰DITO                 â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘                                                           â•‘
â•‘  Factura: 001-001-0000456                                 â•‘
â•‘  Cliente: Juan PÃ©rez                                      â•‘
â•‘  Total:   PYG 12.000.000                                  â•‘
â•‘  Saldo Disponible: PYG 12.000.000                         â•‘
â•‘                                                           â•‘
â•‘  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€     â•‘
â•‘                                                           â•‘
â•‘  Tipo de Nota de CrÃ©dito:                                 â•‘
â•‘                                                           â•‘
â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â•‘
â•‘  â”‚  â— AnulaciÃ³n Total                                â”‚   â•‘
â•‘  â”‚    â””â”€ Anula el 100% del saldo de la factura      â”‚   â•‘
â•‘  â”‚       Monto: PYG 12.000.000                       â”‚   â•‘
â•‘  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â•‘
â•‘                                                           â•‘
â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â•‘
â•‘  â”‚  â—‹ AnulaciÃ³n Parcial                              â”‚   â•‘
â•‘  â”‚    â””â”€ Anula items especÃ­ficos o monto parcial     â”‚   â•‘
â•‘  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â•‘
â•‘                                                           â•‘
â•‘  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€     â•‘
â•‘                                                           â•‘
â•‘                         [Cancelar]  [Continuar â†’]         â•‘
â•‘                                                           â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

### Modal - Paso 2A: NC Total (Detalles)

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘             GENERAR NOTA DE CRÃ‰DITO - TOTAL               â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘                                                           â•‘
â•‘  Factura Afectada: 001-001-0000456                        â•‘
â•‘                                                           â•‘
â•‘  âš ï¸  ADVERTENCIA:                                         â•‘
â•‘  Esta acciÃ³n anularÃ¡ COMPLETAMENTE la factura.            â•‘
â•‘  No se podrÃ¡ revertir.                                    â•‘
â•‘                                                           â•‘
â•‘  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€     â•‘
â•‘                                                           â•‘
â•‘  Motivo: *                                                â•‘
â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â•‘
â•‘  â”‚ CancelaciÃ³n de Reserva                            â–¼â”‚  â•‘
â•‘  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â•‘
â•‘                                                           â•‘
â•‘  Opciones:                                                â•‘
â•‘  â€¢ CancelaciÃ³n de Reserva                                 â•‘
â•‘  â€¢ DevoluciÃ³n                                             â•‘
â•‘  â€¢ Descuento/BonificaciÃ³n                                 â•‘
â•‘  â€¢ Error en FacturaciÃ³n                                   â•‘
â•‘  â€¢ Ajuste de Precio                                       â•‘
â•‘  â€¢ Otro                                                   â•‘
â•‘                                                           â•‘
â•‘  Observaciones:                                           â•‘
â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â•‘
â•‘  â”‚ Cliente cancelÃ³ el viaje por motivos personales.  â”‚  â•‘
â•‘  â”‚ Se procederÃ¡ con el reembolso segÃºn polÃ­tica de   â”‚  â•‘
â•‘  â”‚ cancelaciÃ³n.                                       â”‚  â•‘
â•‘  â”‚                                                    â”‚  â•‘
â•‘  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â•‘
â•‘                                                           â•‘
â•‘  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€     â•‘
â•‘                                                           â•‘
â•‘  Resumen:                                                 â•‘
â•‘  â€¢ Total a Acreditar:  PYG 12.000.000                     â•‘
â•‘  â€¢ Saldo Restante:     PYG 0 (ANULADA)                    â•‘
â•‘                                                           â•‘
â•‘                     [â† AtrÃ¡s]  [Cancelar]  [Generar NC]   â•‘
â•‘                                                           â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

### Modal - Paso 2B: NC Parcial (Detalles)

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘            GENERAR NOTA DE CRÃ‰DITO - PARCIAL              â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘                                                           â•‘
â•‘  Factura Afectada: 001-001-0000456                        â•‘
â•‘  Saldo Disponible: PYG 12.000.000                         â•‘
â•‘                                                           â•‘
â•‘  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€     â•‘
â•‘                                                           â•‘
â•‘  Motivo: *                                                â•‘
â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â•‘
â•‘  â”‚ ReducciÃ³n de Pasajeros                            â–¼â”‚  â•‘
â•‘  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â•‘
â•‘                                                           â•‘
â•‘  Items a Acreditar: *                                     â•‘
â•‘                                                           â•‘
â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â•‘
â•‘  â”‚ Item 1                                             â”‚  â•‘
â•‘  â”‚                                                    â”‚  â•‘
â•‘  â”‚  DescripciÃ³n:                                      â”‚  â•‘
â•‘  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â•‘
â•‘  â”‚  â”‚ Paquete Tour a IguazÃº                        â”‚ â”‚  â•‘
â•‘  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â•‘
â•‘  â”‚                                                    â”‚  â•‘
â•‘  â”‚  Cantidad:          Precio Unitario:              â”‚  â•‘
â•‘  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â•‘
â•‘  â”‚  â”‚ 2            â”‚   â”‚ 2500000                  â”‚ â”‚  â•‘
â•‘  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â•‘
â•‘  â”‚                                                    â”‚  â•‘
â•‘  â”‚  Subtotal: PYG 5.000.000                          â”‚  â•‘
â•‘  â”‚                                        [ğŸ—‘ï¸ Eliminar]â”‚  â•‘
â•‘  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â•‘
â•‘                                                           â•‘
â•‘  [+ Agregar Item]                                         â•‘
â•‘                                                           â•‘
â•‘  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€     â•‘
â•‘                                                           â•‘
â•‘  Observaciones:                                           â•‘
â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â•‘
â•‘  â”‚ 2 pasajeros cancelaron su participaciÃ³n           â”‚  â•‘
â•‘  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â•‘
â•‘                                                           â•‘
â•‘  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€     â•‘
â•‘                                                           â•‘
â•‘  Resumen:                                                 â•‘
â•‘  â€¢ Total a Acreditar:  PYG 5.000.000                      â•‘
â•‘  â€¢ Saldo Disponible:   PYG 12.000.000                     â•‘
â•‘  â€¢ Saldo Restante:     PYG 7.000.000                      â•‘
â•‘                                                           â•‘
â•‘                     [â† AtrÃ¡s]  [Cancelar]  [Generar NC]   â•‘
â•‘                                                           â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

---

## ğŸ“‹ Vista: Lista de NC Existentes

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                    NOTAS DE CRÃ‰DITO                            â•‘
â•‘                    Factura: 001-001-0000456                    â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘                                                                â•‘
â•‘  Resumen:                                                      â•‘
â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â•‘
â•‘  â”‚  Total Original:      PYG 12.000.000                     â”‚ â•‘
â•‘  â”‚  Total Acreditado:    PYG  5.500.000                     â”‚ â•‘
â•‘  â”‚  Saldo Neto:          PYG  6.500.000                     â”‚ â•‘
â•‘  â”‚  Estado:              âš ï¸  PARCIALMENTE ACREDITADA        â”‚ â•‘
â•‘  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â•‘
â•‘                                                                â•‘
â•‘  Notas de CrÃ©dito Emitidas: (2)                                â•‘
â•‘                                                                â•‘
â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â•‘
â•‘  â”‚ ğŸ“‹ NC: 001-001-0000078                                   â”‚ â•‘
â•‘  â”‚                                                          â”‚ â•‘
â•‘  â”‚    Fecha:   15/11/2025 16:45                             â”‚ â•‘
â•‘  â”‚    Tipo:    Parcial                                      â”‚ â•‘
â•‘  â”‚    Motivo:  ReducciÃ³n de Pasajeros                       â”‚ â•‘
â•‘  â”‚    Monto:   PYG 3.000.000                                â”‚ â•‘
â•‘  â”‚                                                          â”‚ â•‘
â•‘  â”‚    Observaciones:                                        â”‚ â•‘
â•‘  â”‚    "2 pasajeros cancelaron su participaciÃ³n"            â”‚ â•‘
â•‘  â”‚                                                          â”‚ â•‘
â•‘  â”‚    Detalles:                                             â”‚ â•‘
â•‘  â”‚    â€¢ Paquete Tour a IguazÃº (2 x 1.500.000)              â”‚ â•‘
â•‘  â”‚                                                          â”‚ â•‘
â•‘  â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚ â•‘
â•‘  â”‚    â”‚  [ğŸ“¥ Descargar PDF]  [ğŸ‘ï¸ Ver] â”‚                   â”‚ â•‘
â•‘  â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚ â•‘
â•‘  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â•‘
â•‘                                                                â•‘
â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â•‘
â•‘  â”‚ ğŸ“‹ NC: 001-001-0000081                                   â”‚ â•‘
â•‘  â”‚                                                          â”‚ â•‘
â•‘  â”‚    Fecha:   18/11/2025 10:20                             â”‚ â•‘
â•‘  â”‚    Tipo:    Parcial                                      â”‚ â•‘
â•‘  â”‚    Motivo:  Descuento/BonificaciÃ³n                       â”‚ â•‘
â•‘  â”‚    Monto:   PYG 2.500.000                                â”‚ â•‘
â•‘  â”‚                                                          â”‚ â•‘
â•‘  â”‚    Observaciones:                                        â”‚ â•‘
â•‘  â”‚    "Descuento por promociÃ³n de temporada baja"          â”‚ â•‘
â•‘  â”‚                                                          â”‚ â•‘
â•‘  â”‚    Detalles:                                             â”‚ â•‘
â•‘  â”‚    â€¢ Descuento Promocional (1 x 2.500.000)              â”‚ â•‘
â•‘  â”‚                                                          â”‚ â•‘
â•‘  â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚ â•‘
â•‘  â”‚    â”‚  [ğŸ“¥ Descargar PDF]  [ğŸ‘ï¸ Ver] â”‚                   â”‚ â•‘
â•‘  â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚ â•‘
â•‘  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â•‘
â•‘                                                                â•‘
â•‘                                             [Cerrar]           â•‘
â•‘                                                                â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

---

## ğŸš¦ Estados de Factura

```
ESTADO 1: ACTIVA (Sin NC)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ“„ Factura: 001-001-0000456                         â”‚
â”‚    Estado: âœ… ACTIVA                                â”‚
â”‚                                                     â”‚
â”‚    â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”“ â”‚
â”‚    â”ƒ  Total:      PYG 12.000.000                  â”ƒ â”‚
â”‚    â”ƒ  Acreditado: PYG          0                  â”ƒ â”‚
â”‚    â”ƒ  Saldo:      PYG 12.000.000 â—„â”€â”€ 100% del    â”ƒ â”‚
â”‚    â”—â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”› â”‚
â”‚                                                     â”‚
â”‚    Acciones Disponibles:                           â”‚
â”‚    â€¢ âœ… Generar NC Total                           â”‚
â”‚    â€¢ âœ… Generar NC Parcial                         â”‚
â”‚    â€¢ âœ… Descargar PDF                              â”‚
â”‚                                                     â”‚
â”‚    NC Asociadas: (0)                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


ESTADO 2: PARCIALMENTE ACREDITADA
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ“„ Factura: 001-001-0000456                         â”‚
â”‚    Estado: âš ï¸  PARCIALMENTE ACREDITADA              â”‚
â”‚                                                     â”‚
â”‚    â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”“ â”‚
â”‚    â”ƒ  Total:      PYG 12.000.000                  â”ƒ â”‚
â”‚    â”ƒ  Acreditado: PYG  5.000.000 â—„â”€â”€ 42% anulado â”ƒ â”‚
â”‚    â”ƒ  Saldo:      PYG  7.000.000 â—„â”€â”€ 58% vÃ¡lido  â”ƒ â”‚
â”‚    â”—â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”› â”‚
â”‚                                                     â”‚
â”‚    Acciones Disponibles:                           â”‚
â”‚    â€¢ âŒ Generar NC Total (BLOQUEADO)               â”‚
â”‚    â€¢ âœ… Generar NC Parcial (por saldo restante)    â”‚
â”‚    â€¢ âœ… Descargar PDF                              â”‚
â”‚                                                     â”‚
â”‚    NC Asociadas: (1) [Ver todas]                   â”‚
â”‚    â””â”€ 001-001-0000078 | Parcial | 5.000.000        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


ESTADO 3: TOTALMENTE ANULADA
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ“„ Factura: 001-001-0000456                         â”‚
â”‚    Estado: ğŸš« TOTALMENTE ANULADA                    â”‚
â”‚                                                     â”‚
â”‚    â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”“ â”‚
â”‚    â”ƒ  Total:      PYG 12.000.000                  â”ƒ â”‚
â”‚    â”ƒ  Acreditado: PYG 12.000.000 â—„â”€â”€ 100% anuladoâ”ƒ â”‚
â”‚    â”ƒ  Saldo:      PYG          0 â—„â”€â”€ SIN VALOR   â”ƒ â”‚
â”‚    â”—â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”› â”‚
â”‚                                                     â”‚
â”‚    Acciones Disponibles:                           â”‚
â”‚    â€¢ âŒ Generar NC Total (BLOQUEADO)               â”‚
â”‚    â€¢ âŒ Generar NC Parcial (BLOQUEADO)             â”‚
â”‚    â€¢ âœ… Descargar PDF                              â”‚
â”‚    â€¢ âœ… Ver NC (consulta)                          â”‚
â”‚                                                     â”‚
â”‚    NC Asociadas: (1) [Ver todas]                   â”‚
â”‚    â””â”€ 001-001-0000080 | Total | 12.000.000         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## âŒ Flujo de Errores

```
ESCENARIO 1: Factura Inactiva
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
Usuario: Click "Generar NC"
    â”‚
    â–¼
Backend valida
    â”‚
    â–¼
Factura.activo = False
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  âŒ ERROR 400                               â”‚
â”‚                                             â”‚
â”‚  "La factura no estÃ¡ activa y no se puede  â”‚
â”‚   generar una nota de crÃ©dito"             â”‚
â”‚                                             â”‚
â”‚  [Cerrar]                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


ESCENARIO 2: Saldo Insuficiente (NC Parcial)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
Usuario: Intenta acreditar PYG 10.000.000
Saldo disponible: PYG 7.000.000
    â”‚
    â–¼
Backend calcula
    â”‚
    â–¼
10.000.000 > 7.000.000
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  âŒ ERROR 400                               â”‚
â”‚                                             â”‚
â”‚  "El monto a acreditar (10.000.000)         â”‚
â”‚   supera el saldo disponible (7.000.000)"  â”‚
â”‚                                             â”‚
â”‚  Saldo mÃ¡ximo: PYG 7.000.000                â”‚
â”‚                                             â”‚
â”‚  [Ajustar Monto]  [Cancelar]                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


ESCENARIO 3: NC Total con NC Parciales Existentes
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
Usuario: Selecciona "NC Total"
Factura ya tiene NC parciales
    â”‚
    â–¼
Backend valida
    â”‚
    â–¼
Existen NC activas (tipo=parcial)
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  âŒ ERROR 400                               â”‚
â”‚                                             â”‚
â”‚  "No se puede generar nota de crÃ©dito      â”‚
â”‚   total si ya existen notas parciales"     â”‚
â”‚                                             â”‚
â”‚  Opciones:                                  â”‚
â”‚  â€¢ Generar NC Parcial por el saldo         â”‚
â”‚    restante (PYG 7.000.000)                â”‚
â”‚                                             â”‚
â”‚  [NC Parcial]  [Cancelar]                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


ESCENARIO 4: Factura Totalmente Anulada
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
Usuario: Click "Generar NC"
Factura.saldo_neto = 0
    â”‚
    â–¼
Frontend valida ANTES de abrir modal
    â”‚
    â–¼
BotÃ³n estÃ¡ deshabilitado
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  â„¹ï¸ INFORMACIÃ“N                             â”‚
â”‚                                             â”‚
â”‚  "Esta factura ya estÃ¡ totalmente anulada" â”‚
â”‚                                             â”‚
â”‚  No es posible generar mÃ¡s notas de        â”‚
â”‚  crÃ©dito.                                   â”‚
â”‚                                             â”‚
â”‚  [Ver NC Existentes]  [Cerrar]              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


ESCENARIO 5: Items VacÃ­os (NC Parcial)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
Usuario: Intenta generar NC Parcial sin items
    â”‚
    â–¼
Frontend valida
    â”‚
    â–¼
items.length === 0
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  âš ï¸ VALIDACIÃ“N                              â”‚
â”‚                                             â”‚
â”‚  "Debe agregar al menos un item para       â”‚
â”‚   generar una nota de crÃ©dito parcial"     â”‚
â”‚                                             â”‚
â”‚  [Agregar Item]                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


ESCENARIO 6: Motivo No Seleccionado
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
Usuario: Click "Generar NC" sin seleccionar motivo
    â”‚
    â–¼
Frontend valida
    â”‚
    â–¼
motivo === null || motivo === ""
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  âš ï¸ VALIDACIÃ“N                              â”‚
â”‚                                             â”‚
â”‚  "El motivo es obligatorio"                â”‚
â”‚                                             â”‚
â”‚  Por favor seleccione un motivo para       â”‚
â”‚  generar la nota de crÃ©dito.               â”‚
â”‚                                             â”‚
â”‚  [Volver]                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”— Endpoints Relacionados

```
API BASE: /api/facturacion/

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  FACTURAS                                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  GET    /facturas-reserva/{reserva_id}/                  â”‚
â”‚  GET    /facturas/{factura_id}/                          â”‚
â”‚  GET    /descargar-pdf/{factura_id}/                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  NOTAS DE CRÃ‰DITO - GENERACIÃ“N                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  POST   /generar-nota-credito-total/{factura_id}/        â”‚
â”‚  POST   /generar-nota-credito-parcial/{factura_id}/      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  NOTAS DE CRÃ‰DITO - CONSULTA                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  GET    /notas-credito/                                  â”‚
â”‚  GET    /notas-credito/{nota_credito_id}/                â”‚
â”‚  GET    /notas-credito-factura/{factura_id}/             â”‚
â”‚  GET    /descargar-pdf-nota-credito/{nota_credito_id}/   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“Š Leyenda de SÃ­mbolos

```
âœ…  Estado activo / AcciÃ³n disponible
âŒ  Estado inactivo / AcciÃ³n bloqueada
âš ï¸   Advertencia / Estado parcial
ğŸš«  Anulado / Prohibido
ğŸ“„  Factura
ğŸ“‹  Nota de crÃ©dito
ğŸ“¥  Descargar
ğŸ”´  AcciÃ³n crÃ­tica
ğŸ‘ï¸   Ver / Consultar
ğŸ—‘ï¸  Eliminar
ğŸ’°  Monto / Dinero
â—   OpciÃ³n seleccionada (radio button)
â—‹   OpciÃ³n no seleccionada (radio button)
[X] Checkbox marcado
[ ] Checkbox desmarcado
```

---

## ğŸ¯ Resumen del Flujo Completo

```
1. ENTRADA
   â””â”€ Detalle de Reserva â†’ Tab Facturas

2. VISUALIZACIÃ“N
   â””â”€ Lista de Facturas con estados y acciones

3. ACCIÃ“N: Generar NC
   â””â”€ Click en botÃ³n "Generar NC"

4. MODAL: SelecciÃ³n de Tipo
   â”œâ”€ NC Total â†’ Formulario Total
   â””â”€ NC Parcial â†’ Formulario Parcial

5. VALIDACIÃ“N
   â”œâ”€ Frontend: Datos requeridos
   â””â”€ Backend: Reglas de negocio

6. PROCESAMIENTO
   â”œâ”€ Crear NC
   â”œâ”€ Generar PDF
   â””â”€ Actualizar factura

7. RESULTADO
   â”œâ”€ [Ã‰XITO] â†’ NotificaciÃ³n + PDF + UI actualizada
   â””â”€ [ERROR] â†’ Mensaje + Volver al formulario

8. POST-GENERACIÃ“N
   â”œâ”€ Factura muestra nuevo estado
   â”œâ”€ NC visible en lista
   â””â”€ BotÃ³n "Generar NC" actualizado segÃºn saldo
```

---

## ğŸ“ Notas TÃ©cnicas

### Validaciones de UI
- Deshabilitar botÃ³n "Generar NC" si factura totalmente anulada
- Validar saldo disponible en tiempo real (NC Parcial)
- Mostrar preview del saldo restante antes de confirmar
- ConfirmaciÃ³n explÃ­cita para NC Total

### Actualizaciones AutomÃ¡ticas
- Recargar facturas despuÃ©s de generar NC
- Actualizar resumen de reserva (si aplica)
- Refrescar totales acreditados
- Invalidar cache de facturas

### UX Recomendada
- Toast/NotificaciÃ³n de Ã©xito con nÃºmero de NC
- Auto-descarga del PDF generado
- BotÃ³n para re-descargar PDF desde lista
- Indicador visual de carga durante generaciÃ³n
- Colores distintivos por estado (Verde/Amarillo/Rojo)

---

**VersiÃ³n:** 1.0
**Fecha:** 06/11/2025
**Autor:** Claude Code
